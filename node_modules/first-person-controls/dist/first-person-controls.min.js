!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("three")):"function"==typeof define&&define.amd?define("first-person-controls",["three"],t):"object"==typeof exports?exports["first-person-controls"]=t(require("three")):e["first-person-controls"]=t(e.three)}("undefined"!=typeof self?self:this,function(e){return function(e){function t(o){if(i[o])return i[o].exports;var s=i[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,o){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,i){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=i(1),n=(i.n(s),function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}()),h=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;o(this,e),this.object=t,this.target=new s.Vector3(0,0,0),this.domElement=i,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.lat=0,this.lon=0,this.phi=0,this.theta=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.mouseDragOn=!1,this.viewHalfX=0,this.viewHalfY=0,this.domElement!==document&&this.domElement.setAttribute("tabindex",-1),this._contextMenu=this.contextMenu.bind(this),this._onMouseMove=this.onMouseMove.bind(this),this._onMouseDown=this.onMouseDown.bind(this),this._onMouseUp=this.onMouseUp.bind(this),this._onKeyDown=this.onKeyDown.bind(this),this._onKeyUp=this.onKeyUp.bind(this),this.handleResize(),this.bindEvents()}return n(e,[{key:"handleResize",value:function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)}},{key:"bindEvents",value:function(){this.domElement.addEventListener("contextmenu",this._contextmenu,!1),this.domElement.addEventListener("mousemove",this._onMouseMove,!1),this.domElement.addEventListener("mousedown",this._onMouseDown,!1),this.domElement.addEventListener("mouseup",this._onMouseUp,!1),window.addEventListener("keydown",this._onKeyDown,!1),window.addEventListener("keyup",this._onKeyUp,!1)}},{key:"onMouseDown",value:function(e){if(this.domElement!==document&&this.domElement.focus(),e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0}},{key:"onMouseUp",value:function(e){if(e.preventDefault(),e.stopPropagation(),this.activeLook)switch(e.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1}},{key:"onMouseMove",value:function(e){this.domElement===document?(this.mouseX=e.pageX-this.viewHalfX,this.mouseY=e.pageY-this.viewHalfY):(this.mouseX=e.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=e.pageY-this.domElement.offsetTop-this.viewHalfY)}},{key:"onKeyDown",value:function(e){switch(e.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0}}},{key:"onKeyUp",value:function(e){switch(e.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}}},{key:"update",value:function(e){if(!1!==this.enabled){if(this.heightSpeed){var t=s.Math.clamp(this.object.position.y,this.heightMin,this.heightMax),i=t-this.heightMin;this.autoSpeedFactor=e*(i*this.heightCoef)}else this.autoSpeedFactor=0;var o=e*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(o+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(o),this.moveLeft&&this.object.translateX(-o),this.moveRight&&this.object.translateX(o),this.moveUp&&this.object.translateY(o),this.moveDown&&this.object.translateY(-o);var n=e*this.lookSpeed;this.activeLook||(n=0);var h=1;this.constrainVertical&&(h=Math.PI/(this.verticalMax-this.verticalMin)),this.lon+=this.mouseX*n,this.lookVertical&&(this.lat-=this.mouseY*n*h),this.lat=Math.max(-85,Math.min(85,this.lat)),this.phi=s.Math.degToRad(90-this.lat),this.theta=s.Math.degToRad(this.lon),this.constrainVertical&&(this.phi=s.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax));var a=this.target,r=this.object.position;a.x=r.x+100*Math.sin(this.phi)*Math.cos(this.theta),a.y=r.y+100*Math.cos(this.phi),a.z=r.z+100*Math.sin(this.phi)*Math.sin(this.theta),this.object.lookAt(a)}}},{key:"contextMenu",value:function(e){e.preventDefault()}},{key:"dispose",value:function(){this.domElement.removeEventListener("contextmenu",this._contextmenu,!1),this.domElement.removeEventListener("mousedown",this._onMouseDown,!1),this.domElement.removeEventListener("mousemove",this._onMouseMove,!1),this.domElement.removeEventListener("mouseup",this._onMouseUp,!1),window.removeEventListener("keydown",this._onKeyDown,!1),window.removeEventListener("keyup",this._onKeyUp,!1)}}]),e}();t.default=h},function(t,i){t.exports=e}])});